# Member

pair9 박지영 박승수<br><br>

<h2>기본기능 구현하였습니다!</h2><br>

## Requirements

- 관통 프로젝트
- Backend
  <br><br>

# 결과화면

### 홈화면



<br><br>

## 제출 소스

| No. ClassName                         | code                                                                 |
| ------------------------------------- | :------------------------------------------------------------------- |
| 1 지역별 관광지 정보 수집 <br>2 관광지, 숙박, 음식점 조회   <br>  3 문화시설, 공연, 여행코스, 쇼핑 조회           | ![Map-Servlet](/uploads/c07ac69bf4aaca2b7add1c5e604dd28a/image.png) | 
|    | ![searchLoc-DAO](/uploads/6b5564acff3b68a3c234addec5033159/image.png)   |
|     | ![searchOption-DAO](/uploads/0157e006cf73351ecca1804adb2adf07/image.png) |
| 7 회원 관리                           |  ![Info](/uploads/973b442ad527d7ec946cb25458cb6d07/image.png) 
|   |  ![SignUp](/uploads/a81292e59f294aec4995871a205d00e0/image.png) |
| 8 로그인 관리                         | ![Login-Servlet](/uploads/010530b025f37d0777d02296a40cc65a/image.png) |
|   | ![info-servlet](/uploads/fe553b7734d1fcebef2a64005ef11a68/image.png) |
|   | ![Login-SessionConfig](/uploads/4f4ee4998cfa6c5c8400eb40c74016da/image.png)  |

# 소감

## 박지영

### 구현 이야기

수업시간에 진행했던 로그인 관리를 토대로 회원관리, 로그인 관리를 만들었습니다.

7. 회원관리
사용자가 회원가입을 하였을 때 유효성 검사를 진행하도록 하였습니다. MemberVO에서 null을 확인하도록 하여 null이 있을 경우 회원가입을 거부하도록 예외처리를 하는 alert를 띄우도록 하였습니다. 이때, DB에서 not null 처리를 안한 상태로 테이블을 생성했더니 null이 그대로 들어가는 것을 확인하였고 DB를 수정해야한다는 것을 알게 되었습니다. 또한 이메일의 경우에는 DB에서 넣기 전에 유효성 검사를 통해 확인하도록 하였습니다.
아이디 중복 확인의 경우 버튼을 하나 추가하여 사용자가 회원가입을 할때 서버로 요청을 보내 중복을 한번 확인하도록 하였습니다. 또한, DB에서도 primary key로 설정이 되어 있어 중복을 방지하도록 하였습니다. 
혹시 사용자가  Info 페이지를 열어서 자신의 정보를 확인할 때 보안적 이슈가 있을지 모른다는 생각이 들었습니다. 그래서 사용자에게 페이지를 보여 줄 때 해당 내용을 .toString()으로 문자열로 변환하도록 하였습니다.

8. 로그인 관리
저희 사이트의 경우에 로그인된 사용자가 이용할 수 있는 곳이 info뿐이었지만 해당 부분에 대해서 로그인된 사용자의 접근인지에 대해서 확인할 수 있는 것에 대해서 고민하였습니다. 그래서 session이 존재하고 memberVO를 담고 있는 세션이 있는지를 확인하여 로그인을 한 사용자인지를 확인할 수 있었습니다. 
중복 로그인에 대해서는 listener을 두어서 세션이 생성되면 Map에 저장하고 해당 사용자가 이미 로그인했는지를 확인하도록 하였고 새로 로그인을 요청할 시 해당 세션으로 바꾸도록 하였습니다. 그 결과 다른 브라우저에서 로그인을 하게 되면 이전 브라우저에서는 info에 접근이 불가능하다는 것을 확인 할 수 있었습니다.

수업시간에 진행했던 로그인이었지만 다양하게 생각해볼 것이 많아서 재밌게 진행할 수 있었습니다. 중복로그인에 대해서 Listener가 아닌 다른 방식이 더 있는지, session에 어떤 정보를 저장하고 저장하면 안될지에 대해서 더 고민하고 공부하고 싶습니다.


## 박승수

### 구현 이야기

검색용 VO와 결과를 받아올 VO를 나눴습니다.
검색용 VO와 받아올 VO를 합치게 된다면 받아올 데이터에 불필요한 값들이 더 추가된다고 생각했습니다.
이는 검색한번에 여러 VO를 리스트로 받고, 수십만개의 request를 받게된다면, 큰 overhead가 발생한다 생각했고, VO를 나눴습니다.

기본적인 기능 구현은 남들과 같을것 같으므로 보안관련 고민한것들을 적어보았습니다.

1. SQL injection => DAO에서 prepareStatement로 구현해 놓았기 때문에 해결이 가능하다고 생각했습니다. 보안을 고민하면서 코드를 만들다 보니 prepareStatement가 정말 좋은거구나.. 싶었습니다.
2. JavaScript Attack 자바스크립트 코드를 넣어서 실행할 수 있기때문에, 완전히 문자열로 바꿔주는 과정을 거쳤습니다.
3.  Session 중복 해결
    1. 먼저 세션이 추가되고, 삭제될때 처리해줘야 하기때문에 이것의 대한 방법을 찾던중  HttpSessionListener 의 sessionCreated과 sessionDestroyed 메서드를 확인했습니다.
    2. 접속했다는 것을 저장할 HashMap을 만들려 했지만, Multi-Thread 환경에서 사용할 수 있고, Null의 key value를 허용하지 않는 ConcurrentHashMap을 찾았고 이 자료구조가 더 적합할거라 생각되어 이곳에서 정보를 저장했습니다.
    3. 이후 로그인시 이곳에서 확인하여 재발급을 하고, 이전 세션을 삭제해주는 로직을 넣어 세션 중복 문제를 해결했습니다.
4. 이메일 유효성 판단을 한번더 하였습니다. 프론트에서 한번 검사하지만, 비정상적인 방법으로 이메일 주소가 아닌 값을 넣을 수 있다고 판단했고, 정규식을 이용하여 걸러내는 작업을 추가하였습니다. 이때, 정규식 로직을 넣는 위치를 고민하였고, VO내에 처음 넣엇지만, VO에서는 로직을 넣는것이 맞지 않다고 판단하여, Static을 이용하여 구현하였습니다.
5. 기본적인 set메서드에서 null체크를 진행하였고, 생성자에서 set메서드를 통해 만들수 있도록 구현하였습니다.


추가하였으면 좋았을점.
다양한 보안 공격중 csrf 공격의 대해서 로직을 넣고싶었으나, 체력 이슈로 추가하지 못했습니다.
더 많은 보안들을 찾는것들이 재미있었고, 함수 위치 하나로도 30분을 떠들수 있다는것을 알게되어 좋았습니다 : )


